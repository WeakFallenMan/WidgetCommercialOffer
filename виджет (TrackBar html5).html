<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Считалка</title>

    <style type="text/css">
        .moneyText {
            width: 100px;
        }
    </style>

</head>
<body>
    <form action="">
        <p>Предмет лизинга:</p>
        <p><input type="radio" name="irr" value="gaz" id="gaz" checked />Автомобили марки ГАЗ</p>
        <p><input type="radio" name="irr" value="other" id="other" />Грузовики и спецтехника</p>
        <p>Стоимость предмета лизинга:</p>
        <p><input type="text" id="tbLeasingAmount" class="moneyText" onchange="calcPercent()" /> руб.</p>
        <p>Авансовый платеж:</p>
        <p>
            <input type="text" id="tbAdvance" onchange="calcPercent()" class="moneyText" /> руб.
            <input type="range" id="ddlPercent" min="0" max="50" onchange="calcAdvance(null)" /> %
            <br />
            Срок лизинга:
            <input type="range" id="ddlMonth" min="6" max="42" />
            мес.
        </p>
        <p><input id="Button1" type="button" value="Рассчитать" onclick="calculate()" /></p>
        <p>Ваш ежемесячный платеж: <input type="text" id="payment" class="moneyText" disabled /> руб.</p>
        <p><input type="button" value="Получить точный расчет и предварительное одобрение" onclick="enterEmail()" /></p>
    </form>
</body>

</html>

<script language="javascript" type="text/javascript">

    function calcPercent() {
        percent = Math.ceil((document.getElementById("tbAdvance").value * 100) / document.getElementById("tbLeasingAmount").value);

        if (percent <= 50)
            document.getElementById("ddlPercent").value = percent;
        else {
            alert("Размер аванса не должен превышать 50% от стоимости предмета лизинга!");
            calcAdvance(50);
        }
    }

    function calcAdvance(percent) {
        if (percent == null)
            percent = document.getElementById("ddlPercent").value;
        else
            document.getElementById("ddlPercent").value = percent;

        document.getElementById("tbAdvance").value = Math.ceil((percent / 100) * document.getElementById("tbLeasingAmount").value);
    }

    function calculate() {
        var irrPercent;

        leasingAmount = document.getElementById("tbLeasingAmount").value;
        advance = document.getElementById("tbAdvance").value;
        advancePercent = document.getElementById("ddlPercent").value;

        if (document.getElementById('gaz').checked) {
            irrPercent = 22;
        } else if (document.getElementById('other').checked) {
            irrPercent = 25;
        }

        c = leasingAmount - ((leasingAmount / 100) * advancePercent);
        b = (irrPercent / 100) / 12;

        document.getElementById("payment").value = Math.ceil((c * b) / (1 - (1 / Math.pow((1 + b), document.getElementById("ddlMonth").value))));
    }

    function enterEmail() {
        var x;
        var email = prompt("Введите свой email:");

        if (email != null) {
            alert("Вы ввели: " + email);
        }
    }

</script>